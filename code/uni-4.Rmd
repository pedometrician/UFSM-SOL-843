---
title: "Unidade IV -- Predição Espacial e Validação Estatística"
output: 
  bookdown::html_document2:
    css: styles.css
lang: pt
bibliography: ~/Dropbox/jabref/biblio.bib
---

```{r, eval=FALSE, echo=FALSE}
rmarkdown::render('uni-4.Rmd', encoding = 'UTF-8', output_dir = "../docs")
```

<div id="summary">
**Temas**: O melhor preditor linear não enviesado empírico. Krigagem simples, ordinária e universal. Funções 
de covariância e os pesos da krigagem. Variância do erro de predição. Suporte de predição. Validação 
estatística de predições espaciais. Validação cruzada. 
</div>

# Predição espacial

Predição significa dizer algo sobre um indivíduo antes de observá-lo. Segundo a terminologia geoestatística
clássica, a predição espacial é chamada de *krigagem*.

A krigagem é um interpolador linear que usa os dados das observações e os parâmetros estimados empiricamente 
da função de covariância para fazer predições espaciais. Assim, de maneira geral, o valor predito do sinal $Z$ 
num determinado ponto $\boldsymbol{s}_0$ será o resultado da soma linear ou média ponderada dos dados em sua 
vizinhança. O principal detalhe da krigagem é a determinação dos pesos usados para calcular essa média 
ponderada.

Como na maioria dos problemas de predição linear, o objetivo da krigagem é fazer uma predição que minimize o 
erro de predição, usando como medida a média do erro quadrado de predição $\text{E}[\hat{Z} - Z]^2$. Assim, os
pesos da krigagem são escolhidos de maneira que a média do erro quadrado de predição seja mínima. Nesse 
sentido, podemos dizer que a krigagem é um método de predição linear ótimo e que produz valores não-enviezados,
ou seja, o melhor preditor linear não enviesado empírico.

## Krigagem simples e krigagem ordinária

Segundo a terminologia geoestatística clássica, a *krigagem simples* consiste na predição espacial dos efeitos 
aleatórios, mais especificamente, de uma superfície $\hat{B}(\boldsymbol{s})$. Conforme vimos anteriormente,
os efeitos aleatórios são uma variável aleatória não-observável, que apresenta correlação espacial, e média 
igual à 0 que, assim como a variância, é constante em toda a área de estudo. Contudo, o termo 
*krigagem simples* também é usado para os casos em que nós simplesmente conhecemos a média -- ou podemos 
assumir que a conhecemos -- e, assim, decidimos modelar separadamente os efeitos fixos e os efeitos aleatórios.

Contudo, em geral, nós não conhecemos a média espacial. Nesse caso é preciso estimá-la a partir dos dados que
possuímos em mãos. Se não tivermos segurança de que a média é constante em toda a área de estudo, então podemos
simplesmente pressupor que seja constante em curtos intervalos de distância (hipótese intrínseca). Nesse caso, 
estaremos então fazendo a predição espacial tanto dos efeitos aleatórios como da média espacial (efeito fixo).
Essa prática é conhecida como *krigagem ordinária* na terminologia geoestatística clássica, e a média pode ser
estimada, por exemplo, via método dos quadrados mínimos generalizado.

A predição espacial do sinal $Z$ em um ponto $\boldsymbol{s}_0$ usando krigagem ordinária sob a hipótese 
intrínseca pode ser representada da seguinte forma:

$$\hat{Z}(\boldsymbol{s}_0) = \sum_{i=1}^n \boldsymbol{\lambda}(\boldsymbol{s}_i) Y(\boldsymbol{s}_i)$$

onde $\boldsymbol{\lambda}(\boldsymbol{s}_i)$ são os *pesos da predição*, também conhecidos na terminologia
geoestatística clássica como *pesos da krigagem*. Esses são atribuídos a cada uma das $n$ observações que 
possuímos em mãos. Na krigagem ordinária, a principal propriedade dos pesos é que precisam somar, 
obrigatoriamente, 1, ou seja, $\sum_{i=1}^n \boldsymbol{\lambda}(\boldsymbol{s}_i) = 1$. Isso garante que as
predições sejam não-enviesadas.

## Krigagem universal

